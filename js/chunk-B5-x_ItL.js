import{u as e,d as l,i as t,_ as a}from"./chunk-B5qR3bqg.js";import{a6 as s,r as n,a as o,w as u,W as i,X as c,a3 as r,bg as d,u as p,F as m,b0 as b,aD as f,U as h,bL as v,bB as x,bA as k,aF as C,aS as w}from"./chunk-DItFX9tw.js";import{l as g}from"./chunk-BcwQrg-K.js";import{s as y}from"./chunk-CsYshFua.js";import{u as U}from"./chunk-B6HHG8fs.js";import"./chunk-ClxWGSjw.js";import"./chunk-DsPhSQSX.js";import"./chunk-COJDRNUs.js";import"./chunk-DUzMzk5W.js";import"./chunk-T1cRhSFL.js";import"./chunk-CjQQEEno.js";import"./chunk-q-ZagYLw.js";import"./chunk-B-qLbzZm.js";import"./chunk-VPk9p_S4.js";import"./chunk-DezxjiP8.js";import"./chunk-DNiUIIzL.js";import"./chunk-BvWJbea5.js";import"./chunk-DbPkkXUs.js";import"./chunk-DHt_odDz.js";import"./chunk-CktjyfsX.js";const j={class:"flex w-full gap-3"},z={role:"alert",class:"w-full my-4 alert alert-info"},L={class:"p-0 m-0"},P={class:"max-w-xs mb-10 form-control"},D={class:"flex flex-col items-center gap-2 pt-5"},A={class:"w-1/2 max-w-xs mb-10 form-control"},V={class:"label"},S={class:"label-text"},M=["onUpdate:modelValue","placeholder"],N={class:"w-1/2 max-w-xs mb-10 form-control"},O={class:"label"},_={class:"label-text"},q=["checked","onChange"],B={class:"w-1/2 max-w-xs mb-10 form-control"},F={class:"label"},H={class:"label-text"},I=["onUpdate:modelValue","placeholder","onChange"],T=["data-tip"],R=["value","max"],W={class:"w-1/2 max-w-xs mb-10 form-control"},X={class:"label"},E={class:"label-text"},G=["checked","onChange"],J={class:"w-full max-w-xs mb-10 form-control"},K={class:"label"},Q={class:"label-text"},Y=["onUpdate:modelValue"],Z={key:0,value:{id:"",name:"",url:""}},$={disabled:"",selected:""},ee=["value"],le={key:0,class:"w-full max-w-xs mb-10 form-control"},te={class:"label"},ae={class:"label-text"},se=["onClick"],ne={key:0,class:"flex flex-wrap w-full h-full gap-1 p-0 pt-1 m-0 cursor-pointer"},oe=["data-tip"],ue={key:1,class:"btn btn-secondary btn-xs"},ie={class:"w-full max-w-xs mb-10 form-control"},ce={class:"label"},re={class:"label-text"},de={class:"flex gap-2"},pe=["onClick"],me=s({__name:"PrizeConfig",setup(s){const{t:me}=U(),be=g.createInstance({name:"imgStore"}),fe=e().prizeConfig,he=e().globalConfig,{getPrizeConfig:ve,getCurrentPrize:xe}=y(fe),{getImageList:ke}=y(he),Ce=n(ve),we=n([]),ge=n();function ye(){const e={id:(new Date).getTime().toString(),name:t.global.t("data.prizeName"),sort:0,isAll:!1,count:1,isUsedCount:0,picture:{id:"",name:"",url:""},separateCount:{enable:!1,countList:[]},desc:"",isUsed:!1,isShow:!0,frequency:1};fe.addPrizeConfig(e)}function Ue(e){ge.value.separateCount.countList=e,ge.value=null}function je(){fe.resetDefault()}function ze(e,l){const t=Ce.value.indexOf(e);1===l?(Ce.value.splice(t,1),Ce.value.splice(t-1,0,e)):(Ce.value.splice(t,1),Ce.value.splice(t+1,0,e))}async function Le(){await fe.deleteAllPrizeConfig()}return o(()=>{!async function(){(await be.keys()).length>0&&be.iterate((e,l)=>{we.value.push({key:l,value:e})})}()}),u(()=>Ce.value,e=>{fe.setPrizeConfig(e)},{deep:!0}),(e,t)=>{var s,n;const o=a;return w(),i("div",null,[c("h2",null,d(p(me)("viewTitle.prizeManagement")),1),c("div",j,[c("button",{class:"btn btn-info btn-sm",onClick:ye},d(p(me)("button.add")),1),c("button",{class:"btn btn-info btn-sm",onClick:je},d(p(me)("button.resetDefault")),1),c("button",{class:"btn btn-error btn-sm",onClick:Le},d(p(me)("button.allDelete")),1)]),c("div",z,[t[0]||(t[0]=c("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 stroke-current shrink-0"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),c("span",null,d(p(me)("dialog.tipResetPrize")),1)]),c("ul",L,[(w(!0),i(m,null,b(Ce.value,e=>(w(),i("li",{key:e.id,class:f(["flex gap-10",p(xe).id===e.id?"border-1 border-dotted rounded-xl":null])},[c("label",P,[c("div",D,[r(o,{class:f(["cursor-pointer hover:text-blue-400",0===Ce.value.indexOf(e)?"opacity-0 cursor-default":""]),name:"up",onClick:l=>ze(e,1)},null,8,["class","onClick"]),r(o,{class:f(["cursor-pointer hover:text-blue-400",Ce.value.indexOf(e)===Ce.value.length-1?"opacity-0 cursor-default":""]),name:"down",onClick:l=>ze(e,0)},null,8,["class","onClick"])])]),c("label",A,[c("div",V,[c("span",S,d(p(me)("table.prizeName")),1)]),v(c("input",{"onUpdate:modelValue":l=>e.name=l,type:"text",placeholder:p(me)("placeHolder.name"),class:"w-full max-w-xs input-sm input input-bordered"},null,8,M),[[x,e.name]])]),c("label",N,[c("div",O,[c("span",_,d(p(me)("table.fullParticipation")),1)]),c("input",{type:"checkbox",checked:e.isAll,class:"mt-2 border-solid checkbox checkbox-secondary border-1",onChange:l=>e.isAll=!e.isAll},null,40,q)]),c("label",B,[c("div",F,[c("span",H,d(p(me)("table.numberParticipants")),1)]),v(c("input",{"onUpdate:modelValue":l=>e.count=l,type:"number",placeholder:p(me)("placeHolder.winnerCount"),class:"w-full max-w-xs p-0 m-0 input-sm input input-bordered",onChange:l=>function(e){let l=-1;for(let t=0;t<Ce.value.length;t++)if(Ce.value[t].id===e.id){l=t;break}l>-1&&(Ce.value[l].separateCount.countList=[],Ce.value[l].isUsed?Ce.value[l].isUsedCount=Ce.value[l].count:Ce.value[l].isUsedCount=0)}(e)},null,40,I),[[x,e.count]]),c("div",{class:"tooltip tooltip-bottom","data-tip":"".concat(p(me)("table.isDone")+e.isUsedCount,"/").concat(e.count)},[c("progress",{class:"w-full progress",value:e.isUsedCount,max:e.count},null,8,R)],8,T)]),c("label",W,[c("div",X,[c("span",E,d(p(me)("table.isDone")),1)]),c("input",{type:"checkbox",checked:e.isUsed,class:"mt-2 border-solid checkbox checkbox-secondary border-1",onChange:l=>function(e){e.isUsed?e.isUsedCount=0:e.isUsedCount=e.count,e.separateCount.countList=[],e.isUsed=!e.isUsed}(e)},null,40,G)]),c("label",J,[c("div",K,[c("span",Q,d(p(me)("table.image")),1)]),v(c("select",{"onUpdate:modelValue":l=>e.picture=l,class:"w-full max-w-xs select select-warning select-sm"},[e.picture.id?(w(),i("option",Z,"âŒ")):h("",!0),c("option",$,d(p(me)("table.selectPicture")),1),(w(!0),i(m,null,b(p(ke),e=>(w(),i("option",{key:e.id,value:e},d(e.name),9,ee))),128))],8,Y),[[k,e.picture]])]),e.separateCount?(w(),i("label",le,[c("div",te,[c("span",ae,d(p(me)("table.onceNumber")),1)]),c("div",{class:"flex justify-start w-full h-full",onClick:l=>function(e){ge.value=e,ge.value.isUsedCount=0,ge.value.isUsed=!1,ge.value.separateCount.countList.length>1||(ge.value.separateCount={enable:!0,countList:[{id:"0",count:e.count,isUsedCount:0}]})}(e)},[e.separateCount.countList.length?(w(),i("ul",ne,[(w(!0),i(m,null,b(e.separateCount.countList,e=>(w(),i("li",{key:e.id,class:"relative flex items-center justify-center w-8 h-8 bg-slate-600/60 separated"},[c("div",{class:"flex items-center justify-center w-full h-full tooltip","data-tip":"".concat(p(me)("tooltip.doneCount")+e.isUsedCount,"/").concat(e.count)},[c("div",{class:"absolute left-0 z-50 h-full bg-blue-300/80",style:C("width:".concat(100*e.isUsedCount/e.count,"%"))},null,4),c("span",null,d(e.count),1)],8,oe)]))),128))])):(w(),i("button",ue,d(p(me)("button.setting")),1))],8,se)])):h("",!0),c("label",ie,[c("div",ce,[c("span",re,d(p(me)("table.operation")),1)]),c("div",de,[c("button",{class:"btn btn-error btn-sm",onClick:l=>function(e){fe.deletePrizeConfig(e.id)}(e)},d(p(me)("button.delete")),9,pe)])])],2))),128))]),r(l,{"total-number":null==(s=ge.value)?void 0:s.count,"separated-number":null==(n=ge.value)?void 0:n.separateCount.countList,onSubmitData:Ue},null,8,["total-number","separated-number"])])}}});export{me as default};
