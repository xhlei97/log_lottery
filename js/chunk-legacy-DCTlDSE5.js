System.register(["./chunk-legacy-j5mDZ0Yx.js","./chunk-legacy-CjKVZ1bp.js","./chunk-legacy-uhuF54xz.js","./chunk-legacy-BWJusyaM.js","./chunk-legacy-PVEcv5sZ.js","./chunk-legacy-CUbBTVRH.js","./chunk-legacy-BE-5mc7C.js","./chunk-legacy---gJkrHA.js","./chunk-legacy-C9K0maxy.js","./chunk-legacy-D3_pZ24x.js","./chunk-legacy-BMwARiCp.js","./chunk-legacy-BYgEWu8h.js","./chunk-legacy-UkeXD8iB.js","./chunk-legacy-CflmvWUy.js","./chunk-legacy-BYxAk2dU.js","./chunk-legacy-CRCEXRIn.js","./chunk-legacy-CNvc6cwk.js","./chunk-legacy-DEnXqUFR.js","./chunk-legacy-aREB5_Re.js","./chunk-legacy-KQLpz-uR.js","./chunk-legacy-DqbqP-9V.js","./chunk-legacy-B_CkxUCE.js","./chunk-legacy-C72SkqAC.js"],function(l,a){"use strict";var e,t,n,o,s,i,c,r,d,u,p,b,g,m,y,h,k,f,j,x;return{setters:[l=>{e=l._},l=>{t=l.u,n=l.i,o=l.b},l=>{s=l.r},l=>{i=l.s},l=>{c=l.u},l=>{r=l.r,d=l.u,u=l.w},l=>{p=l.a6,b=l.r,g=l.a,m=l.W,y=l.X,h=l.bg,k=l.u,f=l.a3,j=l.F,x=l.aS},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const a={class:"modal-box"},v={class:"text-lg font-bold"},_={class:"py-4"},A={class:"modal-action"},N={method:"dialog",class:"flex gap-3"},w={class:"modal-box"},T={class:"text-lg font-bold"},C={class:"py-4"},P={class:"modal-action"},W={method:"dialog",class:"flex gap-3"},z={class:"min-w-1000px"},D={class:"flex gap-3"},S=["data-tip"],J=["download","href"],M={class:""},O={for:"explore"},L=["data-tip"],R={class:"btn btn-primary btn-sm"};l("default",p({__name:"PersonAll",setup(l){const{t:p}=c(),V=t().personConfig,{getAllPersonList:$,getAlreadyPersonList:q}=i(V),E=b(),F=b();async function I(l){const a=await s(l.target.files[0]),e=r(a,{type:"binary",cellDates:!0}),t=e.Sheets[e.SheetNames[0]],n=d.sheet_to_json(t),i=o(n);V.resetPerson(),V.addNotPersonList(i)}function X(){let l=JSON.parse(JSON.stringify($.value));for(let e=0;e<l.length;e++)delete l[e].x,delete l[e].y,delete l[e].id,delete l[e].createTime,delete l[e].updateTime,delete l[e].prizeId,l[e].isWin?l[e].isWin=n.global.t("data.yes"):l[e].isWin=n.global.t("data.no"),l[e].prizeTime=l[e].prizeTime.join(","),l[e].prizeName=l[e].prizeName.join(",");let a=JSON.stringify(l);if(a=a.replaceAll(/uid/g,n.global.t("data.number")).replaceAll(/isWin/g,n.global.t("data.isWin")).replaceAll(/department/g,n.global.t("data.department")).replaceAll(/name/g,n.global.t("data.name")).replaceAll(/identity/g,n.global.t("data.identity")).replaceAll(/prizeName/g,n.global.t("data.prizeName")).replaceAll(/prizeTime/g,n.global.t("data.prizeTime")),l=JSON.parse(a),l.length>0){const a=d.json_to_sheet(l),e=d.book_new();d.book_append_sheet(e,a,"Sheet1"),u(e,"data.xlsx")}}function B(){V.resetAlreadyPerson()}function G(){V.deleteAllPerson()}const H=[{label:n.global.t("data.number"),props:"uid"},{label:n.global.t("data.name"),props:"name"},{label:n.global.t("data.department"),props:"department"},{label:n.global.t("data.avatar"),props:"avatar",formatValue:l=>l.avatar?`<img src="${l.avatar}" alt="avatar" style="width: 50px; height: 50px;"/>`:"-"},{label:n.global.t("data.identity"),props:"identity"},{label:n.global.t("data.isWin"),props:"isWin",formatValue:l=>l.isWin?n.global.t("data.yes"):n.global.t("data.no")},{label:n.global.t("data.operation"),actions:[{label:n.global.t("data.delete"),type:"btn-error",onClick:l=>{!function(l){V.deletePerson(l)}(l)}}]}];return g(()=>{}),(l,t)=>(x(),m(j,null,[y("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:E,class:"border-none modal"},[y("div",a,[y("h3",v,h(k(p)("dialog.titleTip")),1),y("p",_,h(k(p)("dialog.dialogResetWinner")),1),y("div",A,[y("form",N,[y("button",{class:"btn",onClick:t[0]||(t[0]=l=>E.value.close())},h(k(p)("button.cancel")),1),y("button",{class:"btn",onClick:B},h(k(p)("button.confirm")),1)])])])],512),y("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:F,class:"border-none modal"},[y("div",w,[y("h3",T,h(k(p)("dialog.titleTip")),1),y("p",C,h(k(p)("dialog.dialogDelAllPerson")),1),y("div",P,[y("form",W,[y("button",{class:"btn",onClick:t[1]||(t[1]=l=>F.value.close())},h(k(p)("button.cancel")),1),y("button",{class:"btn",onClick:G},h(k(p)("button.confirm")),1)])])])],512),y("div",z,[y("h2",null,h(k(p)("viewTitle.personManagement")),1),y("div",D,[y("button",{class:"btn btn-error btn-sm",onClick:t[2]||(t[2]=l=>F.value.showModal())},h(k(p)("button.allDelete")),1),y("div",{class:"tooltip tooltip-bottom","data-tip":k(p)("tooltip.downloadTemplateTip")},[y("a",{class:"no-underline btn btn-secondary btn-sm",download:k(p)("data.xlsxName"),target:"_blank",href:`/log-lottery/${k(p)("data.xlsxName")}`},h(k(p)("button.downloadTemplate")),9,J)],8,S),y("div",M,[y("label",O,[y("div",{class:"tooltip tooltip-bottom","data-tip":k(p)("tooltip.uploadExcelTip")},[y("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:I},null,32),y("span",R,h(k(p)("button.importData")),1)],8,L)])]),y("button",{class:"btn btn-error btn-sm",onClick:t[3]||(t[3]=l=>E.value.showModal())},h(k(p)("button.resetData")),1),y("button",{class:"btn btn-accent btn-sm",onClick:X},h(k(p)("button.exportResult")),1),y("div",null,[y("span",null,h(k(p)("table.luckyPeopleNumber"))+":",1),y("span",null,h(k(q).length),1),t[4]||(t[4]=y("span",null," / ",-1)),y("span",null,h(k($).length),1)])]),f(e,{"table-columns":H,data:k($)},null,8,["data"])])],64))}}))}}});
